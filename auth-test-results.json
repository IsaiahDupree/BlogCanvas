{"numFailedTestSuites":2,"numFailedTests":7,"numPassedTestSuites":0,"numPassedTests":20,"numPendingTestSuites":0,"numPendingTests":0,"numRuntimeErrorTestSuites":0,"numTodoTests":0,"numTotalTestSuites":2,"numTotalTests":27,"openHandles":[],"snapshot":{"added":0,"didUpdate":false,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0},"startTime":1765081991295,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["E2E Authentication Flow Tests","Complete Sign Up Flow"],"duration":1474,"failing":false,"failureDetails":[{"matcherResult":{"message":"expect(received).toBeNull()\n\nReceived: {\"code\": \"42P17\", \"details\": null, \"hint\": null, \"message\": \"infinite recursion detected in policy for relation \\\"profiles\\\"\"}","pass":false}}],"failureMessages":["Error: expect(received).toBeNull()\n\nReceived: {\"code\": \"42P17\", \"details\": null, \"hint\": null, \"message\": \"infinite recursion detected in policy for relation \\\"profiles\\\"\"}\n    at Object.<anonymous> (C:\\Users\\Isaia\\Documents\\Coding\\BlogCanvas\\__tests__\\integration\\auth-e2e.test.ts:73:34)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"E2E Authentication Flow Tests Complete Sign Up Flow should complete full signup → profile creation → login flow","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1765081992707,"status":"failed","title":"should complete full signup → profile creation → login flow"},{"ancestorTitles":["E2E Authentication Flow Tests","Login and Dashboard Access Flow"],"duration":680,"failing":false,"failureDetails":[{"matcherResult":{"message":"expect(received).toBeTruthy()\n\nReceived: null","pass":false}}],"failureMessages":["Error: expect(received).toBeTruthy()\n\nReceived: null\n    at Object.<anonymous> (C:\\Users\\Isaia\\Documents\\Coding\\BlogCanvas\\__tests__\\integration\\auth-e2e.test.ts:143:29)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"E2E Authentication Flow Tests Login and Dashboard Access Flow should login client user and access client dashboard","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1765081994187,"status":"failed","title":"should login client user and access client dashboard"},{"ancestorTitles":["E2E Authentication Flow Tests","Login and Dashboard Access Flow"],"duration":586,"failing":false,"failureDetails":[{"matcherResult":{"message":"expect(received).toBeTruthy()\n\nReceived: null","pass":false}}],"failureMessages":["Error: expect(received).toBeTruthy()\n\nReceived: null\n    at Object.<anonymous> (C:\\Users\\Isaia\\Documents\\Coding\\BlogCanvas\\__tests__\\integration\\auth-e2e.test.ts:192:29)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"E2E Authentication Flow Tests Login and Dashboard Access Flow should login staff user and access staff dashboard","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1765081994867,"status":"failed","title":"should login staff user and access staff dashboard"},{"ancestorTitles":["E2E Authentication Flow Tests","Password Reset Flow"],"duration":431,"failing":false,"failureDetails":[{"matcherResult":{"message":"expect(received).toBeNull()\n\nReceived: [AuthApiError: Email address \"e2e-reset-1765081995454@example.com\" is invalid]","pass":false}}],"failureMessages":["Error: expect(received).toBeNull()\n\nReceived: [AuthApiError: Email address \"e2e-reset-1765081995454@example.com\" is invalid]\n    at Object.<anonymous> (C:\\Users\\Isaia\\Documents\\Coding\\BlogCanvas\\__tests__\\integration\\auth-e2e.test.ts:228:32)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"E2E Authentication Flow Tests Password Reset Flow should complete password reset flow","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1765081995454,"status":"failed","title":"should complete password reset flow"},{"ancestorTitles":["E2E Authentication Flow Tests","Session Management"],"duration":993,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"E2E Authentication Flow Tests Session Management should maintain session across requests","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"startAt":1765081995885,"status":"passed","title":"should maintain session across requests"},{"ancestorTitles":["E2E Authentication Flow Tests","Session Management"],"duration":551,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"E2E Authentication Flow Tests Session Management should clear session on logout","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1765081996878,"status":"passed","title":"should clear session on logout"}],"endTime":1765081997435,"message":"  ● E2E Authentication Flow Tests › Complete Sign Up Flow › should complete full signup → profile creation → login flow\n\n    expect(received).toBeNull()\n\n    Received: {\"code\": \"42P17\", \"details\": null, \"hint\": null, \"message\": \"infinite recursion detected in policy for relation \\\"profiles\\\"\"}\n\n      71 |                 .single()\n      72 |\n    > 73 |             expect(profileError).toBeNull()\n         |                                  ^\n      74 |             expect(profile).toBeTruthy()\n      75 |             expect(profile?.email).toBe(email)\n      76 |             expect(profile?.role).toBe('client') // Default role\n\n      at Object.<anonymous> (__tests__/integration/auth-e2e.test.ts:73:34)\n\n  ● E2E Authentication Flow Tests › Login and Dashboard Access Flow › should login client user and access client dashboard\n\n    expect(received).toBeTruthy()\n\n    Received: null\n\n      141 |                 .single()\n      142 |\n    > 143 |             expect(profile).toBeTruthy()\n          |                             ^\n      144 |             expect(profile?.role).toBe('client')\n      145 |         })\n      146 |\n\n      at Object.<anonymous> (__tests__/integration/auth-e2e.test.ts:143:29)\n\n  ● E2E Authentication Flow Tests › Login and Dashboard Access Flow › should login staff user and access staff dashboard\n\n    expect(received).toBeTruthy()\n\n    Received: null\n\n      190 |                 .single()\n      191 |\n    > 192 |             expect(profile).toBeTruthy()\n          |                             ^\n      193 |             expect(profile?.role).toBe('staff')\n      194 |         })\n      195 |     })\n\n      at Object.<anonymous> (__tests__/integration/auth-e2e.test.ts:192:29)\n\n  ● E2E Authentication Flow Tests › Password Reset Flow › should complete password reset flow\n\n    expect(received).toBeNull()\n\n    Received: [AuthApiError: Email address \"e2e-reset-1765081995454@example.com\" is invalid]\n\n      226 |\n      227 |             // Reset email should be sent (no error)\n    > 228 |             expect(resetError).toBeNull()\n          |                                ^\n      229 |\n      230 |             // In a real scenario, user would click the link and update password\n      231 |             // For testing, we can update password directly if authenticated\n\n      at Object.<anonymous> (__tests__/integration/auth-e2e.test.ts:228:32)\n","name":"C:\\Users\\Isaia\\Documents\\Coding\\BlogCanvas\\__tests__\\integration\\auth-e2e.test.ts","startTime":1765081992094,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["Authentication Tests - All Endpoints","Public Auth Endpoints"],"duration":11,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Tests - All Endpoints Public Auth Endpoints should allow unauthenticated access to /api/auth/login","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1765081994297,"status":"passed","title":"should allow unauthenticated access to /api/auth/login"},{"ancestorTitles":["Authentication Tests - All Endpoints","Public Auth Endpoints"],"duration":2,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Tests - All Endpoints Public Auth Endpoints should allow unauthenticated access to /api/auth/signup","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1765081994309,"status":"passed","title":"should allow unauthenticated access to /api/auth/signup"},{"ancestorTitles":["Authentication Tests - All Endpoints","Public Auth Endpoints"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Tests - All Endpoints Public Auth Endpoints should allow unauthenticated access to /api/auth/magic-link","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1765081994311,"status":"passed","title":"should allow unauthenticated access to /api/auth/magic-link"},{"ancestorTitles":["Authentication Tests - All Endpoints","Public Auth Endpoints"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Tests - All Endpoints Public Auth Endpoints should allow unauthenticated access to /api/auth/reset-password (POST)","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1765081994313,"status":"passed","title":"should allow unauthenticated access to /api/auth/reset-password (POST)"},{"ancestorTitles":["Authentication Tests - All Endpoints","Protected Auth Endpoints"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Tests - All Endpoints Protected Auth Endpoints should require authentication for /api/auth/me","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1765081994315,"status":"passed","title":"should require authentication for /api/auth/me"},{"ancestorTitles":["Authentication Tests - All Endpoints","Protected Auth Endpoints"],"duration":195,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Tests - All Endpoints Protected Auth Endpoints should return user data when authenticated for /api/auth/me","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1765081994316,"status":"passed","title":"should return user data when authenticated for /api/auth/me"},{"ancestorTitles":["Authentication Tests - All Endpoints","Protected Auth Endpoints"],"duration":2,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Tests - All Endpoints Protected Auth Endpoints should require authentication for /api/auth/logout","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1765081994511,"status":"passed","title":"should require authentication for /api/auth/logout"},{"ancestorTitles":["Authentication Tests - All Endpoints","Protected Auth Endpoints"],"duration":2,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Tests - All Endpoints Protected Auth Endpoints should require authentication for /api/auth/change-email","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1765081994514,"status":"passed","title":"should require authentication for /api/auth/change-email"},{"ancestorTitles":["Authentication Tests - All Endpoints","Protected Auth Endpoints"],"duration":3,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Tests - All Endpoints Protected Auth Endpoints should require authentication for /api/auth/reauth","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1765081994516,"status":"passed","title":"should require authentication for /api/auth/reauth"},{"ancestorTitles":["Authentication Tests - All Endpoints","Portal Endpoints (Client Only)"],"duration":2,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Tests - All Endpoints Portal Endpoints (Client Only) should require authentication for /api/portal/posts/[id]/approve","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1765081994519,"status":"passed","title":"should require authentication for /api/portal/posts/[id]/approve"},{"ancestorTitles":["Authentication Tests - All Endpoints","Portal Endpoints (Client Only)"],"duration":161,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Tests - All Endpoints Portal Endpoints (Client Only) should require client role for /api/portal/posts/[id]/approve","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1765081994521,"status":"passed","title":"should require client role for /api/portal/posts/[id]/approve"},{"ancestorTitles":["Authentication Tests - All Endpoints","Staff Endpoints"],"duration":2,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Tests - All Endpoints Staff Endpoints should require authentication for /api/auth/invite","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1765081994683,"status":"passed","title":"should require authentication for /api/auth/invite"},{"ancestorTitles":["Authentication Tests - All Endpoints","Staff Endpoints"],"duration":147,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Tests - All Endpoints Staff Endpoints should require staff role for /api/auth/invite","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1765081994685,"status":"passed","title":"should require staff role for /api/auth/invite"},{"ancestorTitles":["Authentication Tests - All Endpoints","Session Management"],"duration":76,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Tests - All Endpoints Session Management should maintain session after login","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1765081994832,"status":"passed","title":"should maintain session after login"},{"ancestorTitles":["Authentication Tests - All Endpoints","Session Management"],"duration":155,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Tests - All Endpoints Session Management should clear session after logout","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1765081994908,"status":"passed","title":"should clear session after logout"},{"ancestorTitles":["Authentication Tests - All Endpoints","Role-Based Access Control"],"duration":757,"failing":false,"failureDetails":[{"matcherResult":{"message":"expect(received).toBeTruthy()\n\nReceived: null","pass":false}}],"failureMessages":["Error: expect(received).toBeTruthy()\n\nReceived: null\n    at Object.<anonymous> (C:\\Users\\Isaia\\Documents\\Coding\\BlogCanvas\\__tests__\\integration\\auth-endpoints.test.ts:483:29)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"Authentication Tests - All Endpoints Role-Based Access Control should identify client users correctly","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1765081995063,"status":"failed","title":"should identify client users correctly"},{"ancestorTitles":["Authentication Tests - All Endpoints","Role-Based Access Control"],"duration":741,"failing":false,"failureDetails":[{"matcherResult":{"message":"expect(received).toBeTruthy()\n\nReceived: null","pass":false}}],"failureMessages":["Error: expect(received).toBeTruthy()\n\nReceived: null\n    at Object.<anonymous> (C:\\Users\\Isaia\\Documents\\Coding\\BlogCanvas\\__tests__\\integration\\auth-endpoints.test.ts:517:29)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"Authentication Tests - All Endpoints Role-Based Access Control should identify staff users correctly","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1765081995829,"status":"failed","title":"should identify staff users correctly"},{"ancestorTitles":["Authentication Tests - All Endpoints","Role-Based Access Control"],"duration":757,"failing":false,"failureDetails":[{"matcherResult":{"message":"expect(received).toBeTruthy()\n\nReceived: null","pass":false}}],"failureMessages":["Error: expect(received).toBeTruthy()\n\nReceived: null\n    at Object.<anonymous> (C:\\Users\\Isaia\\Documents\\Coding\\BlogCanvas\\__tests__\\integration\\auth-endpoints.test.ts:551:29)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"Authentication Tests - All Endpoints Role-Based Access Control should identify admin users correctly","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1765081996571,"status":"failed","title":"should identify admin users correctly"},{"ancestorTitles":["Authentication Tests - All Endpoints","Login Flow"],"duration":149,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Tests - All Endpoints Login Flow should login with correct credentials","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"startAt":1765081997328,"status":"passed","title":"should login with correct credentials"},{"ancestorTitles":["Authentication Tests - All Endpoints","Login Flow"],"duration":146,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Tests - All Endpoints Login Flow should reject login with incorrect password","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1765081997477,"status":"passed","title":"should reject login with incorrect password"},{"ancestorTitles":["Authentication Tests - All Endpoints","Login Flow"],"duration":80,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Authentication Tests - All Endpoints Login Flow should reject login with non-existent email","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1765081997623,"status":"passed","title":"should reject login with non-existent email"}],"endTime":1765081997996,"message":"  ● Authentication Tests - All Endpoints › Role-Based Access Control › should identify client users correctly\n\n    expect(received).toBeTruthy()\n\n    Received: null\n\n      481 |\n      482 |             // Profile should exist (created in beforeAll)\n    > 483 |             expect(profile).toBeTruthy()\n          |                             ^\n      484 |             if (profile) {\n      485 |                 expect(profile.role).toBe('client')\n      486 |             }\n\n      at Object.<anonymous> (__tests__/integration/auth-endpoints.test.ts:483:29)\n\n  ● Authentication Tests - All Endpoints › Role-Based Access Control › should identify staff users correctly\n\n    expect(received).toBeTruthy()\n\n    Received: null\n\n      515 |\n      516 |             // Profile should exist (created in beforeAll)\n    > 517 |             expect(profile).toBeTruthy()\n          |                             ^\n      518 |             if (profile) {\n      519 |                 expect(profile.role).toBe('staff')\n      520 |             }\n\n      at Object.<anonymous> (__tests__/integration/auth-endpoints.test.ts:517:29)\n\n  ● Authentication Tests - All Endpoints › Role-Based Access Control › should identify admin users correctly\n\n    expect(received).toBeTruthy()\n\n    Received: null\n\n      549 |\n      550 |             // Profile should exist (created in beforeAll)\n    > 551 |             expect(profile).toBeTruthy()\n          |                             ^\n      552 |             if (profile) {\n      553 |                 expect(profile.role).toBe('admin')\n      554 |             }\n\n      at Object.<anonymous> (__tests__/integration/auth-endpoints.test.ts:551:29)\n","name":"C:\\Users\\Isaia\\Documents\\Coding\\BlogCanvas\\__tests__\\integration\\auth-endpoints.test.ts","startTime":1765081992094,"status":"failed","summary":""}],"wasInterrupted":false}
